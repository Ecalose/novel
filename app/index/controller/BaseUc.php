<?php


namespace app\index\controller;


use app\model\User;
use think\db\exception\DataNotFoundException;
use think\db\exception\ModelNotFoundException;
use think\facade\View;

class BaseUc extends Base
{
    protected $user;
    protected function initialize()
    {
        parent::initialize(); // TODO: Change the autogenerated stub
        $this->uid = cookie('xwx_user_id');
        if (is_null($this->uid)){
            $this->redirect(url('/login'));
        }
        try {
            $this->user = User::findOrFail($this->uid);
        } catch (DataNotFoundException $e) {
            abort(404, $e->getMessage());
        } catch (ModelNotFoundException $e) {
            abort(404, $e->getMessage());
        }
        View::assign([
            'user' => $this->user,
        ]);
    }
}